
// -- user code here --

/* --- start generated code --- */

// Generated by  1.5.2 (Phaser v2.6.2)


/**
 * Level2.
 */
function Level2() {
	
	Phaser.State.call(this);
	
}

/** @type Phaser.State */
var Level2_proto = Object.create(Phaser.State.prototype);
Level2.prototype = Level2_proto;
Level2.prototype.constructor = Level2;

Level2.prototype.init = function () {
	
};

Level2.prototype.preload = function () {
	
	this.load.pack('maze', 'assets/pack.json');
	
};

Level2.prototype.create = function () {
	
	this.cursors = this.input.keyboard.createCursorKeys();
	
	var _bottomLayer = this.add.tilemap('bottomLayer', 32, 32);
	_bottomLayer.addTilesetImage('base_out_atlas1');
	var _bottomLayer_layer = _bottomLayer.createLayer(0);
	_bottomLayer_layer.resizeWorld();
	
	var _BlockLayer = this.add.tilemap('BlockLayer', 32, 32);
	_BlockLayer.addTilesetImage('base_out_atlas1');
	_BlockLayer.setCollision([38,234]);
	var _BlockLayer_layer = _BlockLayer.createLayer(0);
	_BlockLayer_layer.resizeWorld();
	
	var _MidLayer = this.add.tilemap('MidLayer', 32, 32);
	_MidLayer.addTilesetImage('base_out_atlas1');
	var _MidLayer_layer = _MidLayer.createLayer(0);
	_MidLayer_layer.resizeWorld();
	
	var _player = this.add.sprite(3072.0, 320.0, 'atlas', 'misa-front-walk.000');
	_player.animations.add('Back', ['misa-back-walk.000', 'misa-back-walk.001', 'misa-back-walk.002', 'misa-back-walk.003'], 6, true);
	_player.animations.add('Left', ['misa-left-walk.000', 'misa-left-walk.001', 'misa-left-walk.002', 'misa-left-walk.003'], 6, true);
	_player.animations.add('Front', ['misa-front-walk.000', 'misa-front-walk.001', 'misa-front-walk.002', 'misa-front-walk.003'], 6, true);
	_player.animations.add('Right', ['misa-right-walk.000', 'misa-right-walk.001', 'misa-right-walk.002', 'misa-right-walk.003'], 6, true);
	_player.animations.add('BackStay', ['misa-back'], 6, false);
	_player.animations.add('FrontStay', ['misa-front'], 6, false);
	_player.animations.add('LeftStay', ['misa-left'], 6, false);
	_player.animations.add('RightStay', ['misa-right'], 6, false);
	this.game.physics.arcade.enable(_player);
	_player.body.setSize(32.0, 32.0, 0.0, 32.0);
	
	var _keyYellow = this.add.sprite(3200.0, 288.0, 'keyYellow');
	_keyYellow.scale.setTo(0.45714285714285713, 0.45714285714285713);
	this.game.physics.arcade.enable(_keyYellow);
	
	var _treasure_chest = this.add.sprite(3072.0, 288.0, 'treasure chest1', 0);
	_treasure_chest.scale.setTo(0.9142857142857143, 0.9142857142857143);
	_treasure_chest.animations.add('open', [1, 2, 3, 4, 5, 6], 8, false);
	this.game.physics.arcade.enable(_treasure_chest);
	
	this.add.sprite(3552.0, 448.0, 'base_out_atlas', 38);
	
	var _group = this.add.group();
	
	this.add.sprite(2752.0, 256.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(2784.0, 256.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(2816.0, 256.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(2848.0, 256.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(2880.0, 256.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(2912.0, 256.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(2944.0, 256.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(2976.0, 256.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3008.0, 256.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3040.0, 256.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3072.0, 256.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3104.0, 256.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3136.0, 256.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3168.0, 256.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3200.0, 256.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3232.0, 256.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3264.0, 256.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3296.0, 256.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3328.0, 256.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3360.0, 256.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3392.0, 256.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3424.0, 256.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3456.0, 256.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3488.0, 256.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3520.0, 256.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3552.0, 256.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3136.0, 288.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3168.0, 288.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3136.0, 320.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3168.0, 320.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3136.0, 352.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3168.0, 352.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3136.0, 384.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3168.0, 384.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3136.0, 416.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3168.0, 416.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(2752.0, 448.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(2784.0, 448.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(2816.0, 448.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(2848.0, 448.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(2880.0, 448.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(2912.0, 448.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(2944.0, 448.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(2976.0, 448.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3008.0, 448.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3040.0, 448.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3072.0, 448.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3104.0, 448.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3136.0, 448.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3168.0, 448.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3200.0, 448.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3232.0, 448.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3264.0, 448.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3296.0, 448.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3328.0, 448.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3360.0, 448.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3392.0, 448.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3424.0, 448.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3456.0, 448.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3488.0, 448.0, 'base_out_atlas', 38, _group);
	
	this.add.sprite(3520.0, 448.0, 'base_out_atlas', 38, _group);
	
	
	
	// fields
	
	this.fBottomLayer = _bottomLayer;
	this.fBottomLayer_layer = _bottomLayer_layer;
	this.fBlockLayer = _BlockLayer;
	this.fBlockLayer_layer = _BlockLayer_layer;
	this.fMidLayer = _MidLayer;
	this.fMidLayer_layer = _MidLayer_layer;
	this.fPlayer = _player;
	this.fKeyYellow = _keyYellow;
	this.fTreasure_chest = _treasure_chest;
	this.fGroup = _group;
	this.cursors = this.input.keyboard.createCursorKeys();
	this.fPlayer.body.collideWorldBounds=true;
	this.camera.setPosition(2560,0);
	
};

/* --- end generated code --- */
function stop(){
	console.log("true");
	
}
Level2.prototype.update = function () {
	this.fPlayer.body.velocity.set(0);
	if (this.fKeyYellow.exists){
		this.physics.arcade.collide(this.fPlayer,this.fKeyYellow, getKey, null, this);
	}
	this.physics.arcade.collide(this.fPlayer,this.fTreasure_chest,IsOpenChest, null, this);
	this.fTreasure_chest.x = 3072.0;
	this.fTreasure_chest.y = 288.0;

	if (testmode){
		if (this.cursors.left.isDown)
	    {
	    	// move to the left
			
	    	this.fPlayer.play('Left');
	    	this.fPlayer.body.velocity.x -= 150;
	    	//this.fPlayer.body.x -= 32;
	    	play = 'LeftStay';
	        
	    }else if (this.cursors.right.isDown)
	    {
	    	// move to the right
	    	this.fPlayer.play('Right');
	    	this.fPlayer.body.velocity.x += 150;
	    	//this.fPlayer.body.x += 32;
	    	play = 'RightStay';
	    }
	    else  if (this.cursors.up.isDown)
	    {
	    	// move to the up
	    	this.fPlayer.play('Back');
	    	this.fPlayer.body.velocity.y -= 150;
	    	//this.fPlayer.body.y -= 32;
	    	play = 'BackStay';
	    }else if (this.cursors.down.isDown)
	    {
	    	// move to the down
	    	this.fPlayer.play('Front');
	    	this.fPlayer.body.velocity.y += 150;
	    	//this.fPlayer.body.y += 32;
	    	play = 'FrontStay';
	    }else{
	    	this.fPlayer.play(play);
	    }

	}
	this.physics.arcade.collide(this.fPlayer,this.fBlockLayer_layer);

	if ( goToTheLeft)
    {
    	// move to the left
		//101.05263157894632
		goToTheLeft=false;
    	//tween = this.add.tween(this.fPlayer).to( { x: this.fPlayer.body.velocity.x -= 101.05263157894632});
    	this.fPlayer.body.x -= 32;
    	play = 'LeftStay';
        
    }else if (goToTheRight)
    {
    	// move to the right
    	//tween = this.add.tween(this.fPlayer).to( { x: this.fPlayer.body.velocity.x += 101.5961552827511});
    	goToTheRight=false;
    	this.fPlayer.body.x += 32;
    	play = 'RightStay';
    }
    else  if (goToTheUp)
    {
    	// move to the up
    	//tween = this.add.tween(this.fPlayer).to( { y: this.fPlayer.body.velocity.y -= 101.5961552827511});
    	goToTheUp=false;
    	this.fPlayer.body.y -= 32;
    	play = 'BackStay';
    }else if (goToTheDown)
    {
    	// move to the down
    	//tween = this.add.tween(this.fPlayer).to( { y: this.fPlayer.body.velocity.y += 101.5961552827511});
    	goToTheDown=false;
    	this.fPlayer.body.y += 32;
    	play = 'FrontStay';
    }
};
Level2.prototype.render = function () {
	this.game.debug.bodyInfo(this.fPlayer,32, 150);
	this.game.debug.body(this.fPlayer);
};
// -- user code here --
var rightCount=0;
